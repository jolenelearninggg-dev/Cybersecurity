## Memory Forensics (記憶體鑑識)

### 一、 核心觀念：記憶體鑑識的重要性？

#### 在數位鑑識中，記憶體（RAM）被視為「最重要的證據來源」：
  1. 無檔案攻擊 (Fileless Malware)： 現代惡意軟體可以不儲存在硬碟，只存在於記憶體中，並且可以在關機後一起被清除。
  2. 即時狀態： 包含正在運行的程序、網路連線、登入中的帳號密碼。
  3. 加密破解： 許多加密磁碟（如 BitLocker）的密鑰在解鎖狀態下會存在 RAM 中。
備份記憶體（RAM）的過程與硬碟完全不同。硬碟可以「冷處理」（關機後拔除），但 RAM 必須進行「熱處理」（在開機狀態下擷取）。
一旦斷電，記憶體內的電子電荷會迅速流失，資料就會永久消失。所以必須先做"Memory Dump"，將映像檔立即備份回隨身碟(不可存於受害電腦)，並且盡量減少對系統的操作(下載、重啟、存檔等)。

### 二、 工具箱 (Toolkit)

#### 記憶體鑑識分為兩個階段：「擷取」與「分析」，使用的工具不同。
  1. 擷取階段 (Acquisition) - 存放在隨身碟中

  |工具名稱|適用系統|特點|
  |-------|--------|---|
  |FTK Imager Lite|Windows|視覺化介面，最適合新手，免安裝。|
  |DumpIt|Windows|執行即備份，極簡操作，對系統干擾最小。|
  |LiME|Linux|專為 Linux 核心設計，可透過網路傳輸映像檔。|
  |AVML|Linux|微軟開發，獲得 Linux 記憶體映像檔速度快且穩定。|

  2. 分析階段 (Analysis) - 安裝在分析用的電腦上
     
  |工具名稱|特點|
  |-------|----|
  |Volatility 2 / 3|業界標準。開源框架，透過外掛程式（Plugins）分析各類系統資訊。|
  |MemProcFS|將記憶體映像檔掛載成虛擬資料夾，像翻檔案一樣檢查記憶體。|

### 三、 標準作業流程 (SOP)
#### 第一階段：現場採集 (Live Response)
  1. 準備工作： 在乾淨電腦將 FTK Imager Lite 放入具有物理防寫開關的隨身碟。
  2. 介入： 插入受害電腦，絕對不要關機或重新啟動。
  3. 執行： 以管理員權限執行擷取工具。
  4. 輸出： 將 .mem 或 .raw 映像檔儲存至隨身碟（而非受害電腦硬碟）。
  5. 校驗： 完成後記錄檔案的 Hash 值（MD5/SHA256），確保法律效力。
     
#### 第二階段：實驗室分析 (Laboratory Analysis)
使用 Volatility 進行深度檢查，常見指令邏輯如下：
  1. 確認版本： 判斷映像檔的作業系統版本（Image Info）。
  2. 列出程序： 尋找可疑進程（如：孤兒程序、名稱與系統程序相似者）。
  3. 網路檢查： 查看有無連向境外可疑 IP 的連線。
  4. 惡意代碼掃描： 使用 malfind 指令尋找隱藏在合法程序中的惡意代碼。
  5. 提取檔案： 將發現的可疑程式從記憶體中「傾印 (Dump)」出來，送往 VirusTotal 或沙箱分析。

    
### 四、 實務注意事項 (Pro Tips)
- 物理防寫： 隨身碟若無防寫開關，極易被病毒回傳感染。
- Pagefile.sys： 擷取記憶體時，若時間允許，連同硬碟上的「分頁檔案」一起抓取，資訊會更完整。
- 足跡最小化： 在受害電腦上的任何操作（移動滑鼠、點擊視窗）都會改變 RAM 的內容，操作動作愈少愈好。

  
